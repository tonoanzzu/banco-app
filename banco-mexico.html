<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../iron-collapse/iron-collapse.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-input/paper-input.html">

<dom-module id="banco-mexico">
    <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <h1>Banco Mexico</h1>

    <paper-input id="mexicoInput" label="Monto" type="number">
      <div slot="prefix">$</div>
    </paper-input>

    <paper-button on-tap="_ingresarDinero" toggles raised>Ingresar Dinero</paper-button>
    <paper-button on-tap="_retirarDinero"  toggles raised>Retirar Dinero</paper-button>
    
  </template>

    <script>
        /**
         * `banco-mexico`
         * ejercicio de bancos
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class BancoMexico extends Polymer.GestureEventListeners(Polymer.Element) {
            static get is() {
                return 'banco-mexico';
            }
            static get properties() {
                return {
                    currency: {
                        type: String,
                        value: 'MNX',
                        readOnly: true,
                    },
                    amount: {
                        type: Number,
                        value: 0
                    }
                };
            }

            _ingresarDinero() {
                let sumamontovirtual = parseFloat(this.shadowRoot.querySelector('#mexicoInput').value) + this.amount;

                if (sumamontovirtual > 2000) {

                    this.dispatchEvent(new CustomEvent('banco-mexico-name-error', {
                        detail: {
                            error: true,
                            message: 'Error, monto superior al autorizado',
                            banco: 'Banco de Mexico'
                        }
                    }));

                } else {

                    this.amount = sumamontovirtual
                    this.dispatchEvent(new CustomEvent('banco-mexico-name-success', {
                        detail: {
                            error: false,
                            message: 'Operacion exitosa, deposito correcto, actualmente tienes : ' + this.amount + ' ' + this.currency,
                            banco: 'Banco de Mexico'
                        }
                    }));
                }
            }

            _retirarDinero() {

                let restamontovirtual = this.amount - parseFloat(this.shadowRoot.querySelector('#mexicoInput').value);

                if (restamontovirtual < 0) {

                    this.dispatchEvent(new CustomEvent('banco-mexico-name-error', {
                        detail: {
                            error: true,
                            message: 'Error, no se puede realizar retiro por fondos insufucientes',
                            banco: 'Banco de Mexico'
                        }
                    }));

                } else {

                    this.amount = restamontovirtual

                    this.dispatchEvent(new CustomEvent('banco-mexico-name-success', {
                        detail: {
                            error: true,
                            message: 'Operacion exitosa, retiro correcto actualmente tienes : ' + this.amount + ' ' + this.currency,
                            banco: 'Banco de Mexico'
                        }
                    }));
                }

            }
        }

        window.customElements.define(BancoMexico.is, BancoMexico);
    </script>
</dom-module>